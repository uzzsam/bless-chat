{
  "version": 3,
  "sources": ["../widget/src/index.ts"],
  "sourcesContent": ["/*\n  Bless chat widget: mounts into a container that has data-chat-container attribute.\n  Exposes global BlessChat with a mount helper for flexibility, otherwise auto-mounts on DOMContentLoaded.\n*/\n\ntype Role = 'user' | 'assistant';\n\ntype Message = { role: Role; content: string };\n\ntype WidgetOptions = {\n  apiUrl?: string;\n  placeholder?: string;\n  sendAriaLabel?: string;\n  loadingText?: string;\n  requireBlessing?: boolean;\n};\n\nconst DEFAULTS: Required<WidgetOptions> = {\n  apiUrl: 'https://bless-test-brown.vercel.app/api/chat',\n  placeholder: 'Talk to Sidthah',\n  sendAriaLabel: 'Send message',\n  loadingText: 'Listening...',\n  requireBlessing: true,\n};\n\nfunction sanitizeString(value?: string | null): string | undefined {\n  if (value === undefined || value === null) return undefined;\n  const trimmed = value.toString().trim();\n  if (!trimmed) return undefined;\n  const lower = trimmed.toLowerCase();\n  if (lower === 'undefined' || lower === 'null') return undefined;\n  return trimmed;\n}\n\nconst STYLE_BLOCK = `\n:root {\n  --bless-green-900: 23, 95, 75;\n  --bless-green-500: 70, 136, 111;\n  --bless-gold-400: 227, 216, 154;\n  --bless-cream-100: 236, 227, 214;\n}\n\n.bless-chat-shell {\n  width: min(820px, 92vw);\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  gap: 1.75rem;\n  font-family: 'Albert Sans', 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n  color: rgba(var(--bless-cream-100), 0.92);\n}\n\n.bless-chat-window {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  gap: 1.1rem;\n  padding: clamp(1.75rem, 3vw, 2.4rem) clamp(1.5rem, 3vw, 2.8rem);\n  border-radius: 48px;\n  background: linear-gradient(135deg, rgba(20,62,48,0.78), rgba(27,73,58,0.6));\n  box-shadow: 0 26px 70px rgba(0, 0, 0, 0.45);\n  backdrop-filter: blur(18px);\n  border: 1px solid rgba(var(--bless-gold-400), 0.38);\n  overflow: hidden;\n}\n\n.bless-chat-window::after {\n  content: '';\n  position: absolute;\n  inset: 12px;\n  border-radius: 36px;\n  border: 1px solid rgba(255,255,255,0.12);\n  pointer-events: none;\n  opacity: 0.6;\n}\n\n.bless-chat-messages {\n  display: flex;\n  flex-direction: column;\n  gap: 1.1rem;\n  max-height: min(55vh, 500px);\n  overflow-y: auto;\n  padding-right: 0.5rem;\n}\n\n.bless-chat-messages::-webkit-scrollbar {\n  width: 6px;\n}\n\n.bless-chat-messages::-webkit-scrollbar-thumb {\n  background: rgba(var(--bless-cream-100),0.35);\n  border-radius: 999px;\n}\n\n.bless-chat-bubble {\n  position: relative;\n  padding: 1.65rem clamp(1.6rem, 3.8vw, 2.6rem);\n  border-radius: 42px;\n  background: rgba(19, 63, 52, 0.72);\n  border: 1px solid rgba(var(--bless-gold-400), 0.4);\n  box-shadow: 0 18px 45px rgba(0, 0, 0, 0.35);\n  backdrop-filter: blur(14px);\n  color: rgba(var(--bless-cream-100), 0.96);\n  font-size: clamp(1.02rem, 1vw + 0.9rem, 1.2rem);\n  line-height: 1.6;\n}\n\n.bless-chat-bubble--user {\n  align-self: flex-end;\n  background: linear-gradient(120deg, rgba(28,88,70,0.6), rgba(22,65,52,0.7));\n  border: 1px solid rgba(var(--bless-green-500), 0.6);\n  color: rgba(var(--bless-cream-100), 0.9);\n}\n\n.bless-chat-bubble--status {\n  text-align: center;\n  font-size: 0.95rem;\n  color: rgba(var(--bless-cream-100), 0.65);\n  background: rgba(15, 48, 39, 0.4);\n  border: 1px solid rgba(var(--bless-green-500), 0.35);\n}\n\n.bless-chat-input-row {\n  display: flex;\n  gap: 1rem;\n  align-items: center;\n}\n\n.bless-chat-input-wrapper {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  border-radius: 999px;\n  border: 1px solid rgba(var(--bless-green-500), 0.55);\n  background: linear-gradient(120deg, rgba(21,65,53,0.78), rgba(15,52,41,0.74));\n  padding: 0.4rem 0.4rem 0.4rem 1.4rem;\n  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04);\n}\n\n.bless-chat-input {\n  flex: 1;\n  border: none;\n  background: transparent;\n  color: rgba(var(--bless-cream-100), 0.92);\n  font-size: clamp(1.05rem, 2vw, 1.2rem);\n  line-height: 1.4;\n  padding: 0.75rem 0;\n}\n\n.bless-chat-input::placeholder {\n  color: rgba(var(--bless-cream-100), 0.45);\n  opacity: 1;\n}\n\n.bless-chat-input:focus {\n  outline: none;\n}\n\n.bless-chat-send {\n  flex-shrink: 0;\n  width: 64px;\n  height: 64px;\n  border-radius: 999px;\n  border: none;\n  background: radial-gradient(circle at 30% 30%, rgba(var(--bless-gold-400),0.95), rgba(var(--bless-gold-400),0.82));\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: transform 180ms ease, box-shadow 180ms ease;\n  box-shadow: 0 12px 32px rgba(0,0,0,0.32);\n}\n\n.bless-chat-send[disabled] {\n  cursor: not-allowed;\n  opacity: 0.7;\n  transform: none;\n  box-shadow: none;\n}\n\n.bless-chat-send:hover:not([disabled]),\n.bless-chat-send:focus-visible:not([disabled]) {\n  transform: translateY(-2px);\n  box-shadow: 0 18px 40px rgba(0,0,0,0.4);\n}\n\n.bless-chat-send svg {\n  width: 36px;\n  height: 20px;\n}\n\n.bless-chat-error {\n  margin-top: 0.5rem;\n  font-size: 0.95rem;\n  color: rgba(255, 129, 100, 0.88);\n  text-align: center;\n}\n\n@media (max-width: 640px) {\n  .bless-chat-shell {\n    gap: 1.25rem;\n  }\n\n  .bless-chat-window {\n    border-radius: 32px;\n    padding: 1.4rem 1.3rem;\n  }\n\n  .bless-chat-window::after {\n    inset: 8px;\n    border-radius: 26px;\n  }\n\n  .bless-chat-bubble {\n    border-radius: 30px;\n    padding: 1.3rem 1.2rem;\n  }\n\n  .bless-chat-input-wrapper {\n    padding-left: 1.1rem;\n  }\n\n  .bless-chat-send {\n    width: 56px;\n    height: 56px;\n  }\n}\n`;\n\nconst styleEl = document.createElement('style');\nstyleEl.textContent = STYLE_BLOCK;\ndocument.head.appendChild(styleEl);\n\nfunction svgArrow() {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg viewBox=\"0 0 120 64\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <g stroke=\"#175F4B\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path d=\"M14 32H94\" />\n    <path d=\"M70 14L94 32L70 50\" />\n    <circle cx=\"106\" cy=\"32\" r=\"4.5\" fill=\"#175F4B\" stroke=\"#175F4B\" stroke-width=\"2\" />\n  </g>\n</svg>`;\n}\n\nconst SESSION_KEY = 'bless-chat-blessing-created';\n\nconst CLEAN_PATTERNS: RegExp[] = [\n  /Thank you for (sharing|uploading|providing).*?(files?|documents?|that)!?.*$/gim,\n  /How can I assist you with (them|it|the files?)\\?.*$/gim,\n  /Would you like me to search for specific information.*$/gim,\n  /or summarize the content\\?.*$/gim,\n  /\\\u3010\\d+:\\d+\u2020source\\\u3011/g,\n  /To create a personalized blessing.*?providing the files?!?/gim,\n  /and for providing the files?!?/gim\n];\n\nfunction cleanAssistantText(message: string) {\n  let cleaned = message ?? '';\n  CLEAN_PATTERNS.forEach((pattern) => {\n    cleaned = cleaned.replace(pattern, '');\n  });\n  return cleaned.trim();\n}\n\nfunction getSessionFlag(key: string) {\n  try {\n    return typeof sessionStorage !== 'undefined' ? sessionStorage.getItem(key) : null;\n  } catch {\n    return null;\n  }\n}\n\nfunction setSessionFlag(key: string, value: string) {\n  try {\n    if (typeof sessionStorage !== 'undefined') {\n      sessionStorage.setItem(key, value);\n    }\n  } catch {\n    /* ignore storage errors */\n  }\n}\n\nclass BlessChatWidget {\n  private container: HTMLElement;\n  private options: Required<WidgetOptions>;\n  private messages: Message[] = [];\n  private isProcessing = false;\n  private blessingDelivered = false;\n\n  private messageList!: HTMLElement;\n  private inputEl!: HTMLInputElement;\n  private sendBtn!: HTMLButtonElement;\n  private statusEl!: HTMLElement;\n  private errorEl!: HTMLElement;\n  private currentStreamingNode: HTMLDivElement | null = null;\n  private currentStreamingText = '';\n\n  constructor(container: HTMLElement, options?: WidgetOptions) {\n    this.container = container;\n    const merged = { ...DEFAULTS, ...(options || {}) };\n    this.options = {\n      apiUrl: sanitizeString(merged.apiUrl) ?? DEFAULTS.apiUrl,\n      placeholder: sanitizeString(merged.placeholder) ?? DEFAULTS.placeholder,\n      sendAriaLabel: sanitizeString(merged.sendAriaLabel) ?? DEFAULTS.sendAriaLabel,\n      loadingText: sanitizeString(merged.loadingText) ?? DEFAULTS.loadingText,\n      requireBlessing: merged.requireBlessing\n    };\n    this.blessingDelivered = getSessionFlag(SESSION_KEY) === 'true';\n  }\n\n  mount() {\n    this.container.innerHTML = '';\n    this.container.classList.add('bless-chat-shell');\n\n    const windowEl = document.createElement('div');\n    windowEl.className = 'bless-chat-window';\n\n    this.messageList = document.createElement('div');\n    this.messageList.className = 'bless-chat-messages';\n\n    this.statusEl = document.createElement('div');\n    this.statusEl.className = 'bless-chat-bubble bless-chat-bubble--status';\n    this.statusEl.hidden = true;\n\n    this.errorEl = document.createElement('div');\n    this.errorEl.className = 'bless-chat-error';\n    this.errorEl.hidden = true;\n\n    const form = document.createElement('form');\n    form.className = 'bless-chat-input-row';\n\n    const wrapper = document.createElement('div');\n    wrapper.className = 'bless-chat-input-wrapper';\n\n    this.inputEl = document.createElement('input');\n    this.inputEl.type = 'text';\n    this.inputEl.className = 'bless-chat-input';\n    this.inputEl.placeholder = this.options.placeholder;\n    this.inputEl.autocomplete = 'off';\n    this.inputEl.spellcheck = false;\n    this.inputEl.setAttribute('aria-label', this.options.placeholder);\n\n    wrapper.appendChild(this.inputEl);\n\n    this.sendBtn = document.createElement('button');\n    this.sendBtn.type = 'submit';\n    this.sendBtn.className = 'bless-chat-send';\n    this.sendBtn.setAttribute('aria-label', this.options.sendAriaLabel);\n    this.sendBtn.innerHTML = svgArrow();\n\n    form.append(wrapper, this.sendBtn);\n\n    form.addEventListener('submit', (event) => {\n      event.preventDefault();\n      this.handleSubmit();\n    });\n\n    this.messageList.addEventListener('scroll', () => {\n      if (this.messageList.scrollTop === 0) {\n        this.messageList.classList.add('scrolled-top');\n      } else {\n        this.messageList.classList.remove('scrolled-top');\n      }\n    });\n\n    windowEl.append(this.messageList, this.statusEl, form, this.errorEl);\n    this.container.appendChild(windowEl);\n\n    this.inputEl.addEventListener('keydown', (event) => {\n      if (event.key === 'Enter' && !event.shiftKey) {\n        event.preventDefault();\n        this.handleSubmit();\n      }\n    });\n\n    if (this.blessingDelivered) {\n      this.pushAssistantMessage('Your blessing has already been crafted. Scroll to revisit it below.');\n    } else {\n      this.startConversation();\n    }\n  }\n\n  private async startConversation() {\n    await this.fetchAssistantReply();\n  }\n\n  private async handleSubmit() {\n    if (this.isProcessing) return;\n\n    const value = this.inputEl.value.trim();\n    if (!value) {\n      this.inputEl.reportValidity();\n      return;\n    }\n\n    if (this.blessingDelivered && this.options.requireBlessing) {\n      this.pushAssistantMessage('Your blessing has been created. Scroll down to read it.');\n      this.inputEl.value = '';\n      return;\n    }\n\n    this.appendMessage({ role: 'user', content: value });\n    this.inputEl.value = '';\n    this.messages.push({ role: 'user', content: value });\n    await this.fetchAssistantReply();\n  }\n\n  private appendMessage(message: Message, isStreaming = false) {\n    const bubble = document.createElement('div');\n    bubble.className = 'bless-chat-bubble';\n    if (message.role === 'user') {\n      bubble.classList.add('bless-chat-bubble--user');\n    }\n\n    bubble.textContent = message.content;\n    this.messageList.appendChild(bubble);\n    this.scrollToBottom();\n\n    if (message.role === 'assistant' && isStreaming) {\n      this.currentStreamingNode = bubble;\n      this.currentStreamingText = message.content;\n    }\n  }\n\n  private updateStreamingBubble(delta: string) {\n    if (!this.currentStreamingNode) return;\n    this.currentStreamingText += delta;\n    this.currentStreamingNode.textContent = this.currentStreamingText;\n    this.scrollToBottom();\n  }\n\n  private finalizeStreamingBubble(finalText: string) {\n    if (this.currentStreamingNode) {\n      this.currentStreamingNode.textContent = finalText.trim();\n    }\n    this.currentStreamingNode = null;\n    this.currentStreamingText = '';\n    this.scrollToBottom();\n  }\n\n  private pushAssistantMessage(text: string) {\n    const message = { role: 'assistant', content: text } as Message;\n    this.appendMessage(message);\n    this.messages.push(message);\n  }\n\n  private setStatus(text?: string) {\n    if (text) {\n      this.statusEl.textContent = text;\n      this.statusEl.hidden = false;\n    } else {\n      this.statusEl.hidden = true;\n    }\n  }\n\n  private setError(message?: string) {\n    if (message) {\n      this.errorEl.textContent = message;\n      this.errorEl.hidden = false;\n    } else {\n      this.errorEl.hidden = true;\n      this.errorEl.textContent = '';\n    }\n  }\n\n  private scrollToBottom() {\n    requestAnimationFrame(() => {\n      this.messageList.scrollTop = this.messageList.scrollHeight;\n    });\n  }\n\n  private async fetchAssistantReply() {\n    this.isProcessing = true;\n    this.sendBtn.disabled = true;\n    this.setError();\n    this.setStatus(this.options.loadingText);\n\n    const controller = new AbortController();\n\n    try {\n      const response = await fetch(this.options.apiUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ messages: this.messages }),\n        signal: controller.signal\n      });\n\n      this.setStatus();\n\n      if (!response.ok) {\n        const data = await safeJson(response);\n        throw new Error(data?.error || `Request failed with status ${response.status}`);\n      }\n\n      if (isStreamResponse(response)) {\n        await this.handleStream(response);\n      } else {\n        const data = await response.json();\n        const text = (data?.message as string) || '';\n        const done = Boolean(data?.done);\n        if (text) {\n          const cleaned = cleanAssistantText(text);\n          const payload = cleaned || text;\n          this.appendMessage({ role: 'assistant', content: payload });\n          this.messages.push({ role: 'assistant', content: payload });\n          this.onAssistantComplete(payload, done);\n        }\n      }\n    } catch (error: any) {\n      console.error('Bless chat error', error);\n      this.setError(error?.message || 'Something went wrong. Please try again.');\n      this.pushAssistantMessage('I could not continue the conversation. Let us try once more when you are ready.');\n    } finally {\n      this.isProcessing = false;\n      this.sendBtn.disabled = false;\n    }\n  }\n\n  private async handleStream(response: Response) {\n    const reader = response.body?.getReader();\n    if (!reader) {\n      const fallback = await response.text();\n      this.pushAssistantMessage(fallback);\n      return;\n    }\n\n    let doneFlag = false;\n    let finalText = '';\n    let aggregated = '';\n\n    this.appendMessage({ role: 'assistant', content: '', }, true);\n\n    const decoder = new TextDecoder();\n    let buffer = '';\n\n    while (true) {\n      const { value, done } = await reader.read();\n      if (done) break;\n      buffer += decoder.decode(value, { stream: true });\n      const parts = buffer.split('\\n');\n      buffer = parts.pop() || '';\n\n      for (const part of parts) {\n        if (!part.trim()) continue;\n        let payload: any;\n        try {\n          payload = JSON.parse(part);\n        } catch (e) {\n          console.warn('Unable to parse stream chunk', part);\n          continue;\n        }\n\n        if (payload.type === 'response.delta' && typeof payload.delta === 'string') {\n          aggregated += payload.delta;\n          this.updateStreamingBubble(payload.delta);\n        } else if (payload.type === 'response.output_text.delta' && typeof payload.textDelta === 'string') {\n          aggregated += payload.textDelta;\n          this.updateStreamingBubble(payload.textDelta);\n        } else if (payload.type === 'response.message.delta' && typeof payload.delta === 'string') {\n          aggregated += payload.delta;\n          this.updateStreamingBubble(payload.delta);\n        } else if (payload.type === 'response.completed' || payload.type === 'response.stop') {\n          // finalization handled later\n        } else if (payload.type === 'meta' && typeof payload.done === 'boolean') {\n          doneFlag = payload.done;\n        } else if (payload.type === 'final' && typeof payload.text === 'string') {\n          finalText = payload.text;\n          if (typeof payload.done === 'boolean') {\n            doneFlag = payload.done;\n          }\n        } else if (payload.type === 'error') {\n          throw new Error(payload.message || 'Unexpected error');\n        }\n      }\n    }\n\n    const resolved = (finalText || aggregated).trim();\n    const cleaned = cleanAssistantText(resolved);\n    const output = cleaned || resolved;\n    this.finalizeStreamingBubble(output);\n    this.messages.push({ role: 'assistant', content: output });\n    this.onAssistantComplete(output, doneFlag);\n  }\n\n  private onAssistantComplete(text: string, done: boolean) {\n    if (!text) return;\n\n    if (done) {\n      this.blessingDelivered = true;\n      setSessionFlag(SESSION_KEY, 'true');\n      window.dispatchEvent(\n        new CustomEvent('blessing:ready', {\n          detail: {\n            blessing: text,\n            done: true\n          }\n        })\n      );\n    }\n  }\n}\n\nfunction safeJson(response: Response) {\n  return response\n    .clone()\n    .json()\n    .catch(() => ({}));\n}\n\nfunction isStreamResponse(response: Response) {\n  const contentType = response.headers.get('Content-Type') || response.headers.get('content-type');\n  return contentType ? /ndjson|stream/.test(contentType) : false;\n}\n\nfunction resolveContainerConfig(element: HTMLElement): WidgetOptions {\n  const api = sanitizeString(element.dataset.apiUrl);\n  const placeholder = sanitizeString(element.dataset.placeholder);\n  const loading = sanitizeString(element.dataset.loadingText);\n  return {\n    apiUrl: api,\n    placeholder,\n    loadingText: loading\n  };\n}\n\nfunction mount(selector?: string, options?: WidgetOptions) {\n  const target = selector\n    ? document.querySelector<HTMLElement>(selector)\n    : document.querySelector<HTMLElement>('[data-chat-container]');\n\n  if (!target) {\n    console.warn('BlessChat: target container not found.');\n    return;\n  }\n\n  console.info('BlessChat: mounting widget', { selector, target });\n\n  const config = { ...resolveContainerConfig(target), ...(options || {}) };\n  const widget = new BlessChatWidget(target, config);\n  widget.mount();\n}\n\nif (typeof window !== 'undefined') {\n  (window as any).BlessChat = {\n    mount\n  };\n\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => mount());\n  } else {\n    setTimeout(() => mount(), 0);\n  }\n}\n\nexport { mount };\n"],
  "mappings": "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",
  "names": ["index_exports", "__export", "mount", "DEFAULTS", "sanitizeString", "value", "trimmed", "lower", "STYLE_BLOCK", "styleEl", "svgArrow", "SESSION_KEY", "CLEAN_PATTERNS", "cleanAssistantText", "message", "cleaned", "pattern", "getSessionFlag", "key", "setSessionFlag", "BlessChatWidget", "container", "options", "_a", "_b", "_c", "_d", "merged", "windowEl", "form", "wrapper", "event", "isStreaming", "bubble", "delta", "finalText", "text", "controller", "response", "data", "safeJson", "isStreamResponse", "done", "payload", "error", "reader", "fallback", "doneFlag", "aggregated", "decoder", "buffer", "parts", "part", "resolved", "output", "contentType", "resolveContainerConfig", "element", "api", "placeholder", "loading", "selector", "target", "config"]
}
